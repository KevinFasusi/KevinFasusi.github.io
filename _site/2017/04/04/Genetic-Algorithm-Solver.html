  <html>
  <head>
  <!-- _includes/base.html -->



    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css">
    <link rel="stylesheet" href="/stylesheets/styles.css">
    <link rel="stylesheet" href="/stylesheets/pygment_trac.css"> 
    <link rel="stylesheet" href="/stylesheets/syntax.css"> 
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link href='http://fonts.googleapis.com/css?family=Indie+Flower' rel='stylesheet' type='text/css'>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head> 

  </html>

      <body>
<div class="wrapper">
    <header>
        <h1>Sesnse Checking Evolutionary Algorithm Solver For Exponential Smoothing Forecasts</h1>
        </br>
        <p class="view"><a href="https://github.com/KevinFasusi">View My GitHub Profile</a></p>

        <p class="view">
            <!-- Twitter -->
            <a class="btn btn-twitter" href="https://twitter.com/Kevin_Fasusi"><i class="fa fa-twitter"></i> Twitter</a><br/>
            <!-- LinkedIn -->
            <a class="btn btn-linkedin" href="https://t.co/vVIDg5IH6m"><i class="fa fa-linkedin"></i> LinkedIn</a><br/>
            <!-- Googleplus -->
            <a class="btn btn-googleplus" href="https://plus.google.com/u/0/+KevinFasusi/posts"><i
                    class="fa fa-google-plus"></i> Google+</a>
            <br/>
            <a rel="stylesheet" type="text/css" href="/">Blog</a>
            <br/>
            <a rel="stylesheet" type="text/css" href="about/"> About</a>

        </p>

    </header>
    <section>

        <html>
  <head>
  <!-- _includes/base.html -->



    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css">
    <link rel="stylesheet" href="/stylesheets/styles.css">
    <link rel="stylesheet" href="/stylesheets/pygment_trac.css"> 
    <link rel="stylesheet" href="/stylesheets/syntax.css"> 
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link href='http://fonts.googleapis.com/css?family=Indie+Flower' rel='stylesheet' type='text/css'>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head> 

  </html>

        <html>
  <head>
  <!-- _includes/base.html -->



    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />

    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" />
    <link rel="stylesheet" href="/stylesheets/styles.css" />
    <link rel="stylesheet" href="/stylesheets/pygment_trac.css" /> 
    <link rel="stylesheet" href="/stylesheets/syntax.css" /> 
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link href="http://fonts.googleapis.com/css?family=Indie+Flower" rel="stylesheet" type="text/css" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head> 

  </html>

<p>The first forecasting techniques implemented in supplychainpy were, simple and holtâ€™s trend corrected exponential smoothing. I wanted to get some sense of whether the optimisation using the genetic algorithm (GA) solver, was working well. <!--more --></p>

<p>The goal of the GA solver was to find the best smoothing constant, that generated the minimum sum of standard errors. There is a risk that when searching for a minimum value with a GA algorithm results in a local minimum.</p>

<p>For the simple exponential forecast, 2000 results were plotted using random values for the alpha between 0 and 1. The optimisation solver flag was set to <code class="highlighter-rouge">false</code>. The default setting for the GA are <code class="highlighter-rouge">initial_population = 100,  recombination_type='single_point', mutation_probability = 0.2</code>.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="kn">as</span> <span class="nn">mp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span><span class="p">,</span> <span class="n">cm</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sb</span>
<span class="kn">import</span> <span class="nn">random</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">supplychainpy.model_demand</span> <span class="kn">import</span> <span class="n">simple_exponential_smoothing_forecast</span>
<span class="kn">from</span> <span class="nn">supplychainpy.model_demand</span> <span class="kn">import</span> <span class="n">holts_trend_corrected_exponential_smoothing_forecast</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">'figure.figsize'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span><span class="mi">5</span>
<span class="n">cores</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">())</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">ses_alpha</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ses_standard_error</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="n">mp</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">processes</span> <span class="o">=</span><span class="n">cores</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
    <span class="n">ses_forecast</span> <span class="o">=</span> <span class="p">[</span><span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">simple_exponential_smoothing_forecast</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">orders</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">4</span><span class="p">),</span> <span class="bp">False</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">)]</span>
    <span class="n">ses_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">forecast</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">for</span> <span class="n">forecast</span> <span class="ow">in</span> <span class="n">ses_forecast</span><span class="p">]</span>
    <span class="n">ses_alpha</span> <span class="o">=</span> <span class="p">[</span><span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'optimal_alpha'</span><span class="p">)</span> <span class="k">for</span> <span class="n">results</span> <span class="ow">in</span> <span class="n">ses_results</span><span class="p">]</span>
    <span class="n">ses_standard_error</span> <span class="o">=</span> <span class="p">[</span><span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'standard_error'</span><span class="p">)</span> <span class="k">for</span> <span class="n">results</span> <span class="ow">in</span> <span class="n">ses_results</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ses_alpha</span><span class="p">,</span> <span class="n">ses_standard_error</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'alpha'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'standard error'</span><span class="p">)</span></code></pre></figure>

<p>The plot below shows the result for the random alpha values.</p>

<p><img src="/assets/ses_standard_err_alpha.png" alt="ses forecast" title="solution space" /></p>

<p>The simple exponential smoothing forecast was run again 2000 times, this time using the optimisation solver. The resulting scatter graph shows the results group around a minimum value.</p>

<p><img src="/assets/ses_standard_err_alpha2.png" alt="ses forecast" title="solution space" /></p>

<p>The solver seems to be finding locating a value that is close to the minimum.</p>

<p>A similar process was followed for the Random alpha and gamma values were generated for holtâ€™s trend corrected exponential smoothing</p>

<p>To begin the I generated some forecasts using the supplychainpy library:</p>

<p>The results from the excel solver and the implementation in the supplychainpy library were similar. Searching for the minimum value can make it possible that the solution is a local minima and not the global minima. So for a quick sanity check, I ran the solver for a random number of alpha value ( 0&lt; alpha &lt; 1) and plotted the resulting standard error. The code was run inside a Jupyter notebook (there is a link to the notebok at the bottom of the page).</p>

<p>The python implementation is fast and coverges on a solution in (using the %%timeit function in jupyter nootbook).</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></td><td class="code"><pre><span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="kn">as</span> <span class="nn">mp</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span><span class="p">,</span> <span class="n">cm</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

<span class="kn">from</span> <span class="nn">supplychainpy.model_demand</span> <span class="kn">import</span> <span class="n">simple_exponential_smoothing_forecast</span>
<span class="kn">from</span> <span class="nn">supplychainpy.model_demand</span> <span class="kn">import</span> <span class="n">holts_trend_corrected_exponential_smoothing_forecast</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">'figure.figsize'</span><span class="p">]</span> <span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span>
<span class="n">cores</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">())</span>
<span class="n">cores</span> <span class="o">-=</span> <span class="mi">1</span>

<span class="n">orders</span> <span class="o">=</span> <span class="p">[</span><span class="mi">165</span><span class="p">,</span> <span class="mi">171</span><span class="p">,</span> <span class="mi">147</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">164</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">159</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">147</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span>
          <span class="mi">169</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">193</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">208</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">264</span><span class="p">,</span> <span class="mi">304</span><span class="p">]</span>

<span class="n">htces_alphas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">htces_gammas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">htces_standard_error</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">with</span> <span class="n">mp</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="n">cores</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
        <span class="n">htces_forecast</span> <span class="o">=</span> <span class="p">[</span><span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">holts_trend_corrected_exponential_smoothing_forecast</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span><span class="p">(</span><span class="n">orders</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">4</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">4</span><span class="p">),</span> <span class="bp">False</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3000</span><span class="p">)]</span>
        <span class="c">#print(htces_forecast)</span>
        <span class="n">htces_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">forecast</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">for</span> <span class="n">forecast</span> <span class="ow">in</span> <span class="n">htces_forecast</span><span class="p">]</span>
        <span class="c">#print(htces_results)</span>
        <span class="n">htces_alphas</span> <span class="o">=</span> <span class="p">[</span><span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'optimal_alpha'</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'alpha'</span><span class="p">))</span> <span class="k">for</span> <span class="n">results</span> <span class="ow">in</span> <span class="n">htces_results</span><span class="p">]</span>
        <span class="c">#print(htces_alphas)</span>
        <span class="n">htces_gammas</span> <span class="o">=</span> <span class="p">[</span><span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'optimal_gamma'</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'gamma'</span><span class="p">))</span> <span class="k">for</span> <span class="n">results</span> <span class="ow">in</span> <span class="n">htces_results</span><span class="p">]</span>
        <span class="c">#print(htces_gammas)</span>
        <span class="n">htces_standard_error</span> <span class="o">=</span> <span class="p">[</span><span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'standard_error'</span><span class="p">,</span> <span class="n">results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'standard_error'</span><span class="p">))</span> <span class="k">for</span> <span class="n">results</span> <span class="ow">in</span> <span class="n">htces_results</span><span class="p">]</span>
        <span class="c">#print(htces_standard_error)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'alpha'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'gamma'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s">'SSE'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">htces_alphas</span><span class="p">,</span> <span class="n">htces_gammas</span><span class="p">,</span> <span class="n">htces_standard_error</span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>I checked to see if the solutions are good enough i.e. not always finding a local minima. After plotting 3000 results the solution space looked like the chart below:</p>

<p><img src="/assets/htces_random_alpha_and_gamma_no_optimisation.png" alt="Holt's Trend Corrected Solution Space" title="solution space" /></p>

<p>After plotting several random values constants, I ran it again and this time set the optimise flag in the library to True (true by default so just removed the False value for the parameter) the optimised results show a clustering around a the lowest standard error between 20.9 an 20.1 this would indicate that the genetic algorithm is working okay.</p>

<p><img src="/assets/3D_scatter_plot_holts_trend_corrected_es.png" alt="Holt's Trend Corrected Exponential Smoothing Alpha, Gamma, standard error 3D Plot " title="3D Plot" /></p>

<p>The Jupyter Notebook used can be found <a href="">here</a></p>



          </div>

  </body>
</html>



    </section>
</div>
</body>





    </div>

  </body>
</html>
