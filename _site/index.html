<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>KevinFasusi.github.io by KevinFasusi</title>
    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css">
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css"> 
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link href='http://fonts.googleapis.com/css?family=Indie+Flower' rel='stylesheet' type='text/css'>

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
        <header>
        <h1>Kevin Fasusi</h1>
        </br>
        <p class="view"><a href="https://github.com/KevinFasusi">View My GitHub Profile</a></p>

<p class="view">
<!-- Twitter -->
<a class="btn btn-twitter" href="https://twitter.com/Kevin_Fasusi"><i class="fa fa-twitter"></i> Twitter</a><br/>
<!-- LinkedIn -->
<a class="btn btn-linkedin" href="https://t.co/vVIDg5IH6m"><i class="fa fa-linkedin"></i> LinkedIn</a><br/>
<!-- Googleplus -->
<a class="btn btn-googleplus" href="https://plus.google.com/u/0/+KevinFasusi/posts"><i class="fa fa-google-plus" ></i> Google+</a>
<br/>
<a rel="stylesheet" type="text/css" href="mycv/"> My Cv</a>
<br/>
<a rel="stylesheet" type="text/css" href="projects/"> Projects</a>


</p>

      </header>
 <section>   




  <!-- This loops through the paginated posts -->

<br/>
  <h1><a class="posttitle" href="/2015/07/18/Naive-Bayes-Document-Classifier-Part-3/">Naive Bayes Document Classifier Part 3</a></h1>
 <h2 class="postdate">&raquo;July 18, 2015</h2>   
 <!--div class="content">
    <html>
  <head>
  <!-- _includes/base.html -->




    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />

    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" />
    <link rel="stylesheet" href="/stylesheets/styles.css" />
    <link rel="stylesheet" href="/stylesheets/pygment_trac.css" /> 
    <link rel="stylesheet" href="/stylesheets/syntax.css" /> 
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link href="http://fonts.googleapis.com/css?family=Indie+Flower" rel="stylesheet" type="text/css" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head> 

  </html>

<h1 id="naive-bayes-document-classifier-part-3-what-the-wpf">Naive Bayes Document Classifier Part 3-What the WPF!</h1>

  <!/div-->

<br/>
  <h1><a class="posttitle" href="/2015/07/06/Assembling-Adafruit-LCD/">Assembling Adafruit LCD</a></h1>
 <h2 class="postdate">&raquo;July 06, 2015</h2>   
 <!--div class="content">
    <html>
  <head>
  <!-- _includes/base.html -->




    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />

    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" />
    <link rel="stylesheet" href="/stylesheets/styles.css" />
    <link rel="stylesheet" href="/stylesheets/pygment_trac.css" /> 
    <link rel="stylesheet" href="/stylesheets/syntax.css" /> 
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link href="http://fonts.googleapis.com/css?family=Indie+Flower" rel="stylesheet" type="text/css" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head> 

  </html>

<h1 id="a-little-solder-here-a-little-code-there-aaand-464646-i-broke-it">A little solder here, a little code there aaand ... I broke it!</h1>

<div class="res-pic">
<img src="https://dl.dropboxusercontent.com/u/66577714/picstash.com/Adafruit-RGB-LCD-Components.jpg" />
</div>

  <!/div-->

<br/>
  <h1><a class="posttitle" href="/2015/06/02/Naive-Bayes-Document-Classifier-Part-2/">Naive Bayes Document Classifier Part 2</a></h1>
 <h2 class="postdate">&raquo;June 02, 2015</h2>   
 <!--div class="content">
    <html>
  <head>
  <!-- _includes/base.html -->




    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />

    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" />
    <link rel="stylesheet" href="/stylesheets/styles.css" />
    <link rel="stylesheet" href="/stylesheets/pygment_trac.css" /> 
    <link rel="stylesheet" href="/stylesheets/syntax.css" /> 
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link href="http://fonts.googleapis.com/css?family=Indie+Flower" rel="stylesheet" type="text/css" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head> 

  </html>

<h1 id="naive-bayes-document-classifier-part-2-the-good-the-bad-the-vba">Naive Bayes Document Classifier Part 2-The good, the bad, the VBA</h1>

<p>The objective is to automate the whole process; I wanted to drop the files in the folder, and that is it. Using Microsoft Scripting Runtime object library, I used FileSystemObject and textstream instead of the input-output method. The ‘classifier training’ class has a method for extracting and tokenizing the text a sentence at a time from each file in the directory. The ‘.bas’ files are in my repo here.</p>

<p>The first code snippet below shows the iteration through the directory tokenizing the text, removing punctuation and creating the ‘corpuArr’ which holds all the tokenized text from every file placed in the folder. At this point the array will hold duplicates, this is intentional. The duplicates will be removed later when every instance of the same word is tallied.</p>

<h2 id="removing-punctuation-and-tokenizing">Removing Punctuation and Tokenizing.</h2>

<div class="highlight"><pre><code class="language-basic" data-lang="basic"><span class="lineno"> 1</span> <span class="vg">Do</span><span class="w"> </span><span class="vg">While</span><span class="w"> </span><span class="vg">filePath</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
<span class="lineno"> 2</span> <span class="w">        </span><span class="vg">Debug</span><span class="o">.</span><span class="vg">Print</span><span class="w"> </span><span class="vg">filePath</span>
<span class="lineno"> 3</span> <span class="w">        </span><span class="vg">If</span><span class="w"> </span><span class="vg">filePath</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="s2">&quot;ModelData.txt&quot;</span><span class="w"> </span><span class="vg">Then</span>
<span class="lineno"> 4</span> <span class="w">            </span><span class="vg">Do</span><span class="w"> </span><span class="vg">While</span><span class="w"> </span><span class="vg">fsoReadStream</span><span class="o">.</span><span class="vg">AtEndOfStream</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="vg">True</span>
<span class="lineno"> 5</span> <span class="w">                </span><span class="vg">sentenceText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">fsoReadStream</span><span class="o">.</span><span class="vg">ReadLine</span>
<span class="lineno"> 6</span> <span class="w">                </span><span class="vg">sentenceText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">RemoveArtifacts</span><span class="p">(</span><span class="vg">sentenceText</span><span class="p">)</span>
<span class="lineno"> 7</span> <span class="w">                </span><span class="vg">If</span><span class="w"> </span><span class="vg">sentenceText</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="vg">Then</span>
<span class="lineno"> 8</span> <span class="w">                    </span><span class="vg">sentenceArr</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">TokenizeSentence</span><span class="p">(</span><span class="vg">sentenceText</span><span class="p">)</span><span class="w">                </span>
<span class="lineno"> 9</span> <span class="w">                    </span><span class="vg">ReDim</span><span class="w"> </span><span class="vg">Preserve</span><span class="w"> </span><span class="vg">corpusArr</span><span class="p">(</span><span class="vg">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="vg">UBound</span><span class="p">(</span><span class="vg">sentenceArr</span><span class="p">()))</span>
<span class="lineno">10</span> <span class="w">                        </span><span class="vg">For</span><span class="w"> </span><span class="vg">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">0</span><span class="w"> </span><span class="vg">To</span><span class="w"> </span><span class="vg">UBound</span><span class="p">(</span><span class="vg">sentenceArr</span><span class="p">())</span>
<span class="lineno">11</span> <span class="w">                            </span><span class="vg">corpusArr</span><span class="p">(</span><span class="vg">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="vg">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">sentenceArr</span><span class="p">(</span><span class="vg">i</span><span class="p">)</span>
<span class="lineno">12</span> <span class="w">                        </span><span class="vg">Next</span>
<span class="lineno">13</span> <span class="w">                    </span><span class="vg">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="vg">UBound</span><span class="p">(</span><span class="vg">sentenceArr</span><span class="p">())</span>
<span class="lineno">14</span> <span class="w">                </span><span class="nl">Else:</span><span class="w"> </span><span class="vg">End</span><span class="w"> </span><span class="vg">If</span><span class="w">       </span>
<span class="lineno">15</span> <span class="w">            </span><span class="vg">Loop</span>
<span class="lineno">16</span> <span class="w">        </span><span class="vg">Else</span>
<span class="lineno">17</span> <span class="w">        </span><span class="vg">End</span><span class="w"> </span><span class="vg">If</span>
<span class="lineno">18</span> <span class="w">        </span><span class="vg">filePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">Dir</span><span class="p">()</span>
<span class="lineno">19</span> <span class="w">    </span>
<span class="lineno">20</span> <span class="w">        </span><span class="vg">fsoReadStream</span><span class="o">.</span><span class="vg">Close</span>
<span class="lineno">21</span> <span class="w">        </span><span class="vg">Set</span><span class="w"> </span><span class="vg">fsoSourceFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">fsoSource</span><span class="o">.</span><span class="vg">GetFile</span><span class="p">(</span><span class="vg">folderPath</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="vg">pathSep</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="vg">filePath</span><span class="p">)</span>
<span class="lineno">22</span> <span class="w">        </span><span class="vg">Set</span><span class="w"> </span><span class="vg">fsoReadStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">fsoSourceFile</span><span class="o">.</span><span class="vg">OpenAsTextStream</span><span class="p">(</span><span class="vg">ForReading</span><span class="p">,</span><span class="w"> </span><span class="vg">TristateUseDefault</span><span class="p">)</span>
<span class="lineno">23</span> <span class="vg">Loop</span></code></pre></div>

<p>Below is the method for removing punctuation, it’s not pretty but it gets the job done.</p>

<div class="highlight"><pre><code class="language-basic" data-lang="basic"><span class="lineno">1</span> <span class="vg">Private</span><span class="w"> </span><span class="vg">Function</span><span class="w"> </span><span class="vg">RemoveArtifacts</span><span class="p">(</span><span class="vg">sentence</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">String</span><span class="p">)</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">String</span>
<span class="lineno">2</span> 
<span class="lineno">3</span> <span class="w">    </span><span class="vg">RemoveArtifacts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Replace</span><span class="p">(</span><span class="vg">LCase</span><span class="p">(</span><span class="vg">sentence</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;. &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;, &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;: &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="w"> </span><span class="vg">_</span>
<span class="lineno">4</span> <span class="w">                                </span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&#39; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;! &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;# &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;$&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;%&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;(&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;)&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot; - &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;--&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;+&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="w"> </span><span class="vg">_</span>
<span class="lineno">5</span> <span class="w">                                </span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;\&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;{&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;}&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;[&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;]&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;&quot;&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;?&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot; &quot;&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot;&quot;&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="lineno">6</span> <span class="w">                                </span>
<span class="lineno">7</span> <span class="vg">End</span><span class="w"> </span><span class="vg">Function</span></code></pre></div>

<p>Below is the method for tokenizing senetence.</p>

<div class="highlight"><pre><code class="language-basic" data-lang="basic"><span class="lineno"> 1</span> <span class="vg">Private</span><span class="w"> </span><span class="vg">Function</span><span class="w"> </span><span class="vg">TokenizeSentence</span><span class="p">(</span><span class="vg">sentence</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">String</span><span class="p">)</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">Variant</span>
<span class="lineno"> 2</span> <span class="vg">Dim</span><span class="w"> </span><span class="vg">i</span><span class="p">,</span><span class="w"> </span><span class="vg">counter</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">Integer</span>
<span class="lineno"> 3</span> <span class="vg">Dim</span><span class="w"> </span><span class="vg">bagOfCharArr</span><span class="p">()</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">String</span>
<span class="lineno"> 4</span> <span class="vg">Dim</span><span class="w"> </span><span class="vg">bagOfWordsArr</span><span class="p">()</span><span class="w"> </span><span class="vg">As</span><span class="w"> </span><span class="vg">String</span>
<span class="lineno"> 5</span> 
<span class="lineno"> 6</span> <span class="vg">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">0</span>
<span class="lineno"> 7</span> <span class="w">    </span><span class="vg">bagOfCharArr</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">Split</span><span class="p">(</span><span class="vg">sentence</span><span class="p">)</span>
<span class="lineno"> 8</span> <span class="w">    </span><span class="vg">ReDim</span><span class="w"> </span><span class="vg">bagOfWordsArr</span><span class="p">(</span><span class="vg">UBound</span><span class="p">(</span><span class="vg">bagOfCharArr</span><span class="p">()))</span>
<span class="lineno"> 9</span> <span class="w">        </span><span class="vg">For</span><span class="w"> </span><span class="vg">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">0</span><span class="w"> </span><span class="vg">To</span><span class="w"> </span><span class="vg">UBound</span><span class="p">(</span><span class="vg">bagOfCharArr</span><span class="p">())</span>
<span class="lineno">10</span> <span class="w">            </span><span class="vg">If</span><span class="w"> </span><span class="vg">Not</span><span class="w"> </span><span class="vg">Replace</span><span class="p">(</span><span class="vg">Trim</span><span class="p">(</span><span class="vg">bagOfCharArr</span><span class="p">(</span><span class="vg">i</span><span class="p">)),</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="vg">Then</span>
<span class="lineno">11</span> <span class="w">                </span><span class="vg">bagOfWordsArr</span><span class="p">(</span><span class="vg">counter</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">bagOfCharArr</span><span class="p">(</span><span class="vg">i</span><span class="p">)</span>
<span class="lineno">12</span> <span class="w">                </span><span class="vg">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">counter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="il">1</span>
<span class="lineno">13</span> <span class="w">            </span><span class="nl">Else:</span><span class="w"> </span><span class="vg">End</span><span class="w"> </span><span class="vg">If</span>
<span class="lineno">14</span> <span class="w">        </span><span class="vg">Next</span>
<span class="lineno">15</span> <span class="w">    </span><span class="vg">If</span><span class="w"> </span><span class="vg">counter</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="il">0</span><span class="w"> </span><span class="vg">Then</span>
<span class="lineno">16</span> <span class="w">    </span><span class="vg">ReDim</span><span class="w"> </span><span class="vg">Preserve</span><span class="w"> </span><span class="vg">bagOfWordsArr</span><span class="p">(</span><span class="vg">counter</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="il">1</span><span class="p">)</span>
<span class="lineno">17</span> <span class="w">    </span><span class="nl">Else:</span><span class="w"> </span><span class="vg">End</span><span class="w"> </span><span class="vg">If</span>
<span class="lineno">18</span> <span class="w">        </span>
<span class="lineno">19</span> <span class="vg">wordArr</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">bagOfWordsArr</span><span class="p">()</span>
<span class="lineno">20</span> <span class="vg">TokenizeSentence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">bagOfWordsArr</span><span class="p">()</span>
<span class="lineno">21</span> <span class="vg">End</span><span class="w"> </span><span class="vg">Function</span></code></pre></div>

<h2 id="stop-words">Stop Words</h2>

<p>At this stage it is normal to remove ‘stop words’, these are words with little lexical content (Foreman, 2014:91). However, as advised in the data smart book, removing all words with four characters or less proved a useful quick and dirty method. I had planned on incorporating a list of stop words and I may yet still.</p>

<h2 id="tokens-and-probabilities">Tokens and Probabilities</h2>

<p>After tokenizing the sentences and removing the punctuation, the next step is to count the tokens and calculate the conditional probabilities. The cleaned tokens (stop words and punctuation removed) are tallied, and the frequency of each word is stored in a 2-dimentional array (tallyCorpusArr).</p>

<div class="highlight"><pre><code class="language-basic" data-lang="basic"><span class="lineno"> 1</span> <span class="vg">wordFromArr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">cleanCorpusArr</span><span class="p">(</span><span class="vg">i</span><span class="p">,</span><span class="w"> </span><span class="il">0</span><span class="p">)</span>
<span class="lineno"> 2</span> <span class="vg">If</span><span class="w"> </span><span class="vg">wordFromArr</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="vg">Then</span>
<span class="lineno"> 3</span> <span class="w">    </span><span class="vg">matchCondition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">chkArray</span><span class="p">(</span><span class="vg">wordFromArr</span><span class="p">,</span><span class="w"> </span><span class="vg">tallyCorpusArr</span><span class="p">)</span>
<span class="lineno"> 4</span> <span class="w">        </span><span class="vg">If</span><span class="w"> </span><span class="vg">matchCondition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">False</span><span class="w"> </span><span class="vg">Then</span>
<span class="lineno"> 5</span> <span class="w">            </span><span class="vg">tallyCorpusArr</span><span class="p">(</span><span class="vg">p</span><span class="p">,</span><span class="w"> </span><span class="il">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">cleanCorpusArr</span><span class="p">(</span><span class="vg">i</span><span class="p">,</span><span class="w"> </span><span class="il">0</span><span class="p">)</span>
<span class="lineno"> 6</span> <span class="w">            </span><span class="vg">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">0</span>
<span class="lineno"> 7</span> <span class="w">            </span><span class="vg">tallyCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="il">0</span>
<span class="lineno"> 8</span> <span class="w">            </span><span class="vg">Do</span><span class="w"> </span><span class="vg">Until</span><span class="w"> </span><span class="vg">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">UBound</span><span class="p">(</span><span class="vg">cleanCorpusArr</span><span class="p">())</span>
<span class="lineno"> 9</span> <span class="w">                </span><span class="vg">If</span><span class="w"> </span><span class="vg">tallyCorpusArr</span><span class="p">(</span><span class="vg">p</span><span class="p">,</span><span class="w"> </span><span class="il">0</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">cleanCorpusArr</span><span class="p">(</span><span class="vg">j</span><span class="p">,</span><span class="w"> </span><span class="il">0</span><span class="p">)</span><span class="w"> </span><span class="vg">Then</span>
<span class="lineno">10</span> <span class="w">                    </span><span class="vg">tallyCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">tallyCount</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="il">1</span>
<span class="lineno">11</span> <span class="w">                    </span><span class="vg">tallyCorpusArr</span><span class="p">(</span><span class="vg">p</span><span class="p">,</span><span class="w"> </span><span class="il">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">tallyCount</span>
<span class="lineno">12</span> <span class="w">                </span><span class="nl">Else:</span><span class="w"> </span><span class="vg">End</span><span class="w"> </span><span class="vg">If</span>
<span class="lineno">13</span> <span class="w">                 </span><span class="vg">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="il">1</span>
<span class="lineno">14</span> <span class="w">            </span><span class="vg">Loop</span>
<span class="lineno">15</span> <span class="w">              </span><span class="vg">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="vg">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="il">1</span>
<span class="lineno">16</span> <span class="w">        </span><span class="nl">Else:</span><span class="w"> </span><span class="vg">End</span><span class="w"> </span><span class="vg">If</span>
<span class="lineno">17</span> <span class="nl">Else:</span><span class="w"> </span><span class="vg">End</span><span class="w"> </span><span class="vg">If</span>
<span class="lineno">18</span> 
<span class="lineno">19</span> <span class="vg">Next</span></code></pre></div>

<p>The cumulative total of all the tokens is then calculated and used to calculate the probability of each token in the corpus. The normal logarithmic probability is calculated using the LN function. The actual tally, additive smoothed tally, probability and LN probability are then added to an array before writing to a text file. An example of the files content is below.</p>

<table>
    <thead>
        <tr>
            <th>Token</th>
            <th>Tally Count</th>
            <th>Additive Smoothed Tally</th>
            <th>Probability</th>
            <th>Logarithmic Probability</th>
        </tr>
    </thead>
    <tr>
        <td>information</td>
        <td>207</td>
        <td>208</td>
        <td>0.0041823337</td>
        <td>2.3159703876</td>
    </tr>
    <tr>
        <td>management</td>
        <td>355</td>
        <td>356</td>
        <td>0.0071582249</td>
        <td>2.5502283777</td>
    </tr>
</table>


  <!/div-->

<br/>
  <h1><a class="posttitle" href="/2015/06/01/Naive-Bayes-Document-Classifier-Part-1/">Naive Bayes Document Classifier Part 1</a></h1>
 <h2 class="postdate">&raquo;June 01, 2015</h2>   
 <!--div class="content">
    <html>
  <head>
  <!-- _includes/base.html -->




    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />

    <link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" />
    <link rel="stylesheet" href="/stylesheets/styles.css" />
    <link rel="stylesheet" href="/stylesheets/pygment_trac.css" /> 
    <link rel="stylesheet" href="/stylesheets/syntax.css" /> 
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link href="http://fonts.googleapis.com/css?family=Indie+Flower" rel="stylesheet" type="text/css" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head> 

  </html>

<h1 id="naive-bayes-document-classifier-part-1-you-did-what">Naive Bayes Document Classifier Part 1-You did what?</h1>

<p>For my thesis, I am expected to write a literature review. The literature review is supposed to summarise the corpus of literature that covers my field of enquiry. The review has to be systematic, which in short means exhaustive and capable of being audited.</p>

<p>To focus the literature search, you take keywords and create search terms. The search terms are then chained together to create search string. Depending on the database these search strings are then used to interrogate a journal database such as Science Direct, Proquest, etc.</p>

<p>When discriminating between irrelevant and relevant articles, hard exclusion criteria are used. The criteria can be the year of publication, peer-review, etc. I found these easy to implement, they are objective and can in most cases be implemented using the filtering mechanism of the journal database being queried.</p>

<p>A flow diagram detailing the exclusion process is illustrated in the <a href="http://www.amazon.co.uk/Business-Research-Practical-Undergraduate-Postgraduate/dp/0230301835/ref=sr_1_sc_1?ie=UTF8&amp;qid=1437217747&amp;sr=8-1-spell&amp;keywords=business+research+jill+colis">Business Research</a> book written by Dr Jill Collis. The diagram is taken from my research, as one of many examples from willing research students for this book. Dr Collis is an excellent lecturer and researcher in Accounting and It was an honour to be asked to participate</p>

<p>Some Irrelevant articles are capable of making it past the hard criteria filter.  Often after reading the abstract and maybe a few pages, I can decide on the articles relevance to my research. I wanted a quicker method, one that was systematic and scientific but also quick and if possible automated. I started to read around.</p>

<p>Early on in my reading I came across natural language processing and sentiment analysis. These topics lead me on to machine learning and then to a python library named NLTK. After further reading, I understood that using a trained copra, I could classify unknown text. So I took a look at Python. I had used python before but for statistical calculations for supply chain inventory planning and forecasting. I had knowledge of limited libraries and never worked with machine learning. For my efforts, I only managed to get a crap line chart for the word frequency in my training corpus. I do not mean to disparage NLTK; my failure was all on me. My approach to learning the library was wrong.  I realised that I would have to take a step back.</p>

<p>I have experience working with VBA (please don’t judge me). I had written several applications and had increasingly focused on writing VBA like a true OOP language, which it is not. I later found out about a book called <a href="http://www.amazon.co.uk/Data-Smart-Science-Transform-Information/dp/111866146X/ref=sr_1_1?ie=UTF8&amp;qid=1437218510&amp;sr=8-1&amp;keywords=data+smart">Data Smart</a> by John W. Foreman. In the book, Naive Bayes Classification is explained using tweets and excel. My first thought was, “This Guy!…” With all the anti-excel sentiment out there, Mr Foreman was a breath of fresh air. Don’t get me wrong I do not advocate using the wrong tools for the job, but for the comprehension of the subject matter this suited me just fine. Another <a href="https://www.google.co.uk/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0CCIQFjAAahUKEwjb2t2py-TGAhWIbRQKHU0-A4k&amp;url=http%3A%2F%2Fweb4.cs.ucl.ac.uk%2Fstaff%2FD.Barber%2Ftextbook%2F090310.pdf&amp;ei=HDqqVdvcJojbUc38jMgI&amp;usg=AFQjCNE1DaK9fD5mFcKXuRpSylvEP2wNsg&amp;sig2=mZOo915kIYGLkWCaGfbZ_Q&amp;bvm=bv.98197061,d.d24">book</a> by David Barber a Reader Information Processing in the department of Computer Science UCL, along with several articles and blogs helped me get a better understanding. Then I had a dangerous Idea. You know where I am going with this. I thought to myself “Why not write a Naive Bayes Classifier in VBA…<a href="https://youtu.be/V2rG8nKh4Cc?t=1m26s">Why not!</a>” (think John Wilkinson the comedian when saying the why not! This dude is the voice in my head for some reason). I know this is blasphemy, why would I rewrite something that has been rewritten to death…Why not!</p>

<p><img src="/assets/printoutNBC.png" alt="screenshot NBC excel application" title="NBC Screenshot" /></p>

<p>An output file for each model is consists of a list of every word occurring in the corpus. The format looks similar to the table below.</p>

<table>
<thead>
	<tr>
		<th>Token</th>
		<th>Tally Count</th>
		<th>Additive Smoothed Tally</th>
		<th>Probability</th>
		<th>Logarithmic Probability</th>
	</tr>
</thead>
<tr>
	<td>information</td>
	<td>207</td>
	<td>208</td>
	<td>0.0041823337</td>
	<td>2.3159703876</td>
</tr>
<tr>
	<td>management</td>
	<td>355</td>
	<td>356</td>
	<td>0.0071582249</td>
	<td>2.5502283777</td>
</tr>
</table>

<p>The workflow for using the application is very simplpe.</p>

<ul>
  <li>
    <p><strong>Settting up a project</strong> to create a folder structure that includes, 2 folders for the training copra used to model the conditional probabilities, 1 folder for the unclassified documents and 1 folder for the pre-classified files used to calculate the models accuracy.</p>
  </li>
  <li>
    <p><strong>Loading folders with training files</strong>, in my case articles I had already classified as relevant or irrelevant after the hard exclusion criteria had been applied and each had been read. Place a selection of these classified files in each folder.</p>
  </li>
  <li>
    <p><strong>Validating the model</strong>. Pre-classified files are used to test the accuracy of the model.</p>
  </li>
  <li>
    <p><strong>Classifying unclassified files</strong>. If the models validity is adequate then continue on to classify the unknown documents.</p>
  </li>
</ul>

<p>I discuss actually building the classifier in the next post and a demo in the final post in this series.</p>

  <!/div-->


<!-- Pagination links -->
<div class="pagination">
  
    <span class="previous">Previous</span>
  
  <span class="page_number ">Page: 1 of 1</span>
  
    <span class="next ">Next</span>
  
</div>
</html>
